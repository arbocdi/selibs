!function(a,b){var c=window;c.APP&&APP.core&&APP.sandbox&&APP.sandbox.plugin(a,b),c[a]=b()}("templateBuilder",function(){"use strict";function a(){throw new TypeError("Illegal constructor")}function b(){throw new TypeError("Illegal constructor")}var c,d,e=window,f=e.document,g=!1;return a.implement({defaultVariables:{external:function(a){var b,c=document.getElementById(a),d=a;return c?(c.removeAttribute("id"),c.setAttribute("data-fromid",d),b=c.outerHTML,c.setAttribute("id",d),c.removeAttribute("data-fromid"),b):""},translate:function(a,b){return!g&&e.APP?(e.APP.i18n(),c=e.APP().pKey,g=!0):!c&&e.APP&&(c=e.APP().pKey),c?c.getItem(a,b):void 0},htmlEncode:function(a){var b=this[a];if(void 0!==b)return String(b).htmlEncode()}},getInstance:function(b){var c,d=Object.create(a.prototype);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},getItem:function(a){var b,c,d,e=this;for(a=a.split("."),c=0,d=a.length;d>c;c+=1){if(b=a[c],!e.hasOwnProperty(b))return void 0;e=e[b]}return e},setItem:function(a,b){var c,d,e,f=this;for(a=a.split("."),d=0,e=a.length;e>d;d+=1)c=a[d],d===e-1?f[c]=b:f.hasOwnProperty(c)||(f[c]={}),f=f[c];return this},replaceItemVariables:function(a,b){var c=this.getItem(a);if(void 0===c)throw new Error("Zmienna o nazwie: "+a+" nie istnieje");if("string"!=typeof c)throw new Error("Zmienna o nazwie: "+a+" nie jest type string");return c=c.replace(/\{\{([^:]+?)\}\}/g,function(a,c){var d=b.hasOwnProperty(c)&&b[c];return"string"==typeof d?d:a}),this.setItem(a,c),this},create:function(a){var b=this;return a&&(b=this.getItem(a)),this.getInstance(b)},build:function(a,c){var d,e,g,h,i=Object.create(b.prototype,{elements:{value:Object.create(APP.Namespace.prototype),writable:!0}}),j="div",k={li:"ul",tbody:"table",thead:"table",tfoot:"table",tr:"tbody",td:"tr",th:"tr",option:"select"};if(d=this.prepareItem(a,c),"object"==typeof a&&(c=a.decorator),d.replace(/^\s*<\s*(.*?)(\s|>)/,function(a,b){b=b.toLowerCase(),h=b,k[b]&&(j=k[b])}),g=f.createElement(j),g.insertAdjacentHTML("beforeEnd",d),h!==g.children[0].tagName.toLowerCase()&&(g.innerHTML=d),g.children.length>1)for(e=f.createDocumentFragment();g.children.length;)e.appendChild(g.children[0]);else e=g.children[0],g.removeChild(e);return i.wrapper=e,"function"==typeof c?c.call(e,i):i},prepareItem:function(a,b){var c,d,e,f=this.defaultVariables;if("object"==typeof a&&(b=a.decorator,c=a.predecorator,d=a.variables,a=a.name),b&&"object"==typeof b&&(d=b),e=this.getItem(a),void 0===e)throw new Error("Zmienna o nazwie: "+a+" nie istnieje");if("string"!=typeof e)throw new Error("Zmienna o nazwie: "+a+" nie jest type string");return d=d||f,d&&"function"!=typeof c&&(e=e.replace(/\{\{([^:]+?)(\.(.*?))?\}\}/g,function(a,b,c,e){var g,h=d[b],i=typeof h;return"undefined"===i&&void 0!==f[b]&&(h=f[b],i=typeof h),"function"===i?(g=void 0!==e?h.apply(d,e.split("|")):h.call(d),void 0===g?a:g):!d.hasOwnProperty(b)||"string"!==i&&"number"!==i?a:h})),"function"==typeof c&&(e=c.call(e)),e}}),b.inherits(null,{wrapper:{set:function(a){var b,c,d,e,f,g=this.elements;if(Object.defineProperty(this,"wrapper",{value:a,writable:!0}),a&&a.querySelectorAll)for(a.getAttribute&&(f=a.getAttribute("data-define"),f&&(this[f]=a,g&&"function"==typeof g.setItem&&g.setItem(f,a),a.removeAttribute("data-define"))),b=a.querySelectorAll("[data-define]"),c=0,d=b.length;d>c;c+=1)e=b[c],f=e.getAttribute("data-define"),e.removeAttribute("data-define"),this[f]=e,g&&"function"==typeof g.setItem&&g.setItem(f,e)},configurable:!0}}).implement({insert:function(a,b){if(b=b||"beforeEnd",!this.wrapper)return a;switch(b){case"afterBegin":a=a.insertBefore(this.wrapper,a.firstChild);break;case"beforeBegin":a=a.parentNode.insertBefore(this.wrapper,a);break;case"afterEnd":a=a.parentNode.insertBefore(this.wrapper,a.nextSibling);break;default:a=a.appendChild(this.wrapper)}return a},remove:function(){var a,b=this.wrapper;return b&&(a=b.parentNode,a&&(b=a.removeChild(b))),b}}),d=function(b,c){var d={};return c&&("function"==typeof c.decorator||"function"==typeof c.predecorator||c.variables&&"object"==typeof c.variables?d={decorator:c.decorator,predecorator:c.predecorator,variables:c.variables}:d.variables=c),d.name="template",a.prototype.getInstance({template:b}).build(d)},d.augment({getInstance:a.prototype.getInstance,createTemplateFromElement:function(a){var c=Object.create(b.prototype,{elements:{value:Object.create(APP.Namespace.prototype),writable:!0}});return c.wrapper=a,c},extendProto:function(c){c.call(this,{templateBuilderProto:a.prototype,templateProto:b.prototype})}}),Object.defineProperty(d,"translationRun",{get:function(){return g},set:function(a){g=a}}),APP.box&&!APP.box.tplBuilder&&(APP.box.tplBuilder=d.getInstance({})),d});